<section class="section">
  <div class="container">

    {{!--Merchant article options--}}
    <div class="columns">
      <div class="column is-half">
        <div class="content">
          {{#link-to 'merchant.index' metadatum.id (query-params filter='new')
                     class='button is-outlined is-primary'
                     activeClass='is-active'}}New{{/link-to}}
          {{#link-to 'merchant.index' metadatum.id (query-params filter='sale')
                     class='button is-outlined is-primary'
                     activeClass='is-primary is-active'}}Sale{{/link-to}}
          {{#link-to 'merchant.index' metadatum.id (query-params filter='all')
                     class='button is-outlined is-primary'
                     activeClass='is-primary'}}All{{/link-to}}
        </div>
        <div class="content">
          {{#link-to 'merchant.index' metadatum.id (query-params order='name')
                     class='button is-outlined is-primary'
                     activeClass='is-active'}}
            Name
          {{/link-to}}
          {{#link-to 'merchant.index' metadatum.id (query-params order='price')
                     class='button is-outlined is-primary'
                     activeClass='is-active'}}
            <span class="icon is-small">
              {{fa-icon 'money'}}
            </span>
            <span>Price</span>
          {{/link-to}}
          {{#link-to 'merchant.index' metadatum.id (query-params order='created_at')
                     class='button is-outlined is-primary'
                     activeClass='is-active'}}
            <span class="icon is-small">
              {{fa-icon 'calendar-o'}}
            </span>
            <span>Created</span>
          {{/link-to}}
          {{#link-to 'merchant.index' metadatum.id (query-params order='updated_at')
                     class='button is-outlined is-primary'
                     activeClass='is-active'}}
            <span class="icon is-small">
              {{fa-icon 'calendar-o'}}
            </span>
            <span>Updated</span>
          {{/link-to}}
        </div>
      </div>
    </div>

    {{!--Pagination--}}
    <div class="columns">
      <div class="column">
        {{ui.-pager current=articles.meta.current-page
                    count=articles.meta.total-pages
                    change=(action '_pageChanged')}}
      </div>
    </div>

    {{!--Articles list--}}
    {{#each articles as |article|}}
      <div class="columns">
        <div class="column is-half">
          <div class="media">
            <div class="media-left">
              <button class="button is-light">
                {{fa-icon 'eye'}}
              </button>
            </div>
            <div class="media-content">
              <div class="content">
                {{#link-to 'articles.index' article.id}}
                  <p class="title is-4">
                    {{article.name}}
                  </p>
                  <p class="subtitle is-6">
                    {{article.description}}
                  </p>
                {{/link-to}}
              </div>
            </div>
          </div>
        </div>
        <div class="column is-3">
          <p class="title is-4">
            {{ui.-money article.price}}
          </p>
        </div>
        <div class="column is-3">
          <p class="price-history">
            {{ui.sparkline.-line data=(map-by 'price' (reverse (take 45 (sort-by 'createdAt:desc' article.priceHistory))))}}
          </p>
        </div>
      </div>
    {{/each}}

    <hr>

    {{!--Pagination--}}
    {{ui.-pager current=articles.meta.current-page
                count=articles.meta.total-pages
                change=(action '_pageChanged')}}
  </div>
</section>
